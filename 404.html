<!DOCTYPE html>
<html lang="en">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<link rel="icon" type="image/x-icon" href="/assets/media/favicon.ico">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Our Story</title>
	<script>
		window.onload = function () {
		const menu_btn = document.querySelector('.hamburger');
		const mobile_menu = document.querySelector('.mobile-nav');

		menu_btn.addEventListener('click', function () {
			menu_btn.classList.toggle('is-active');
			mobile_menu.classList.toggle('is-active');
		});
	}
        document.addEventListener('DOMContentLoaded', () => {
            const video = document.getElementById('hoverVideo');
            video.pause();
            video.addEventListener('mouseover', () => {
                video.play();
            });
            video.addEventListener('mouseout', () => {
                video.pause();
                video.currentTime = 0;
            });
        });
	</script>
    <style>
        @font-face { font-family: MinecraftTen; src: url('/assets/fonts/MinecraftTen.woff'); } 
        @font-face { font-family: Minecraft; src: url('/assets/fonts/Minecraft.otf'); } 
        @font-face { font-family: MinecraftTest; src: url('/assets/fonts/MinecraftTest.otf'); } 
        @font-face { font-family: MinecraftFive; src: url('/assets/fonts/MinecraftFive-Regular.woff2'); }

        body::-webkit-scrollbar {
            display: none;
        }
        #fakeLogo {
            position: fixed;
            height: 5vw;
            display: flex;
            align-items: center;
            margin-left: 5.5vw;
            font-family: 'MinecraftTen';
            font-size: 2vw;
            line-height: 0.85;
        }
        body {
            overflow-x: hidden;
            font-family: 'Minecraft';
            background-color: #F8ECEC;
            margin: 0;
        }
        .topnav {
            z-index: 30;
            background-color: #FFFFFF;
            height: 5vw;
            top: 0;
            position: -webkit-sticky;
            position: sticky;
        }

        .topnav a {
            font-family: 'MinecraftTen';
            float: right;
            display: block;
            color: #373097;
            text-align: center;
            padding: 1.2vw 1.5vw;
            text-decoration: none;
            font-size: 2vw;
            transition: 0.15s;
        }

        .topnav a:hover {
            background-color: #e9d3ff;
            color: #8000ff;
        }

        .topnav a.active {
            background-color: #4d009a;
            color: white;
        }

        .topnav .icon {
            display: none;
        }
        #mobileNav {
            display: none;
        }
        .hamburger {
            margin: 2vw;
            margin-left: 85vw;
            z-index: 200;
            display: none;
            position: fixed;
            width: 50px;
            cursor: pointer;
            appearance: none;
            background: none;
            outline: none;
            border: none;
        }
        .hamburger .bar, .hamburger:after, .hamburger:before {
            content: '';
            display: block;
            width: 100%;
            height: 5px;
            background-color: #4229B9;
            margin: 6px 0px;
            transition: 0.4s;
        }

        .hamburger.is-active:before {
            transform: rotate(-45deg) translate(-8px, 6px);
        }

        .hamburger.is-active:after {
            transform: rotate(45deg) translate(-9px, -8px);
        }

        .hamburger.is-active .bar {
            opacity: 0;
        }
        h2 {
            font-family: 'MinecraftTen';
            font-size: 3vw;
            margin-top: 5vh;
            margin-left: 10vw;
            margin-bottom: 6vh;
        }
        .mobile-nav {
            display: none;
            position: fixed;
            top: 0;
            left: 100%;
            width: 100%;
            min-height: 100vh;
            background-color: white;
            padding-top: 120px;
            transition: 0.4s;
        }

        .mobile-nav.is-active {
            left: 0;
        }

        .mobile-nav a {
            display: block;
            width: 100%;
            max-width: 200px;
            margin: 0 auto 16px;
            text-align: center;
            padding: 12px 16px;
            text-decoration: none;
        }
        .hidden{
            height: 4.5vw;
        }
        .box {
            width: 35vw; 
            height: fit-content;
            overflow: hidden;
            background-color: white;
            box-sizing: border-box;
            border-radius: 10px;
            transition: 0.3s;
            margin-right: 5vw;
        }
        .box img{
            width: 35vw;
            height: auto;
            transition: 0.3s;
        }
        .box a{
            display: flex;
            height: fit-content;
        }
        .box:hover > a > img{
            width: 40vw;
        }
        .box:hover{
            width: 40vw;
        }
        .container {
            display: flex;
            row-gap: 5vh;
            flex-wrap: wrap;
            margin-left: 10vw;
            margin-top: 10vh;
            margin-bottom: 10vh;
            width: 90vw;
        }
        .knowSelect {
            margin-left: 10vw;
            font-family: 'Minecraft';
            z-index: 97;
            height: 5vh;
            font-size: 3.5vh;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            font-weight: bold;
        }
        #content{
            padding-left: 15vw;
            padding-right: 15vw;
        }
        #video{
            width: 70vw;
            height: 80vh
        }
        .section {
            letter-spacing: -0.1vw;
            line-height: 4.5vh;
            font-size: 1.5vw;
            padding-bottom: 8vh;
            text-align: center;
        }
        #content > img {
            border-radius: 20px;
            width: 70vw;
        }
        #content > video {
            border-radius: 20px;
            width: 70vw;
        }
        .downloadSection{
            display: flex;
            width: 100vw;
            font-size: 2vw;
            letter-spacing: -0.15vw;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        input[type="checkbox"] {
            transform: scale(3) translateY(-1px);
            margin-right: 40px;
            appearance: none;
            border: 2px solid #4d009a;
            width: 20px;
            height: 20px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        input[type="checkbox"]:checked {
            content: "\2713";
            color: #fff;
            background-color: #4d009a;
            animation: checkboxPulse 0.4s;
        }
        input[type="checkbox"]:checked:after {
            content: "âœ“";
            color: #fff;
            position: absolute;
            left: 50%;
            top: 50%;
            -webkit-transform: translate(-50%,-50%);
            -moz-transform: translate(-50%,-50%);
            -ms-transform: translate(-50%,-50%);
            transform: translate(-50%,-50%);
        }
        .warning {
            color:red;
            letter-spacing: -1px;
            font-size: 1.5vw;
            width: 100vw;
            height: 10vh;
            text-align: center;
        }
        .compiler {
            display: none;
            width: 100vw; 
            height: 100vh; 
            background-color: rgba(0, 0, 0, 0.85); 
            position: fixed; 
            z-index: 48; 
            top: 0;
            align-items: center; 
            justify-content: center;
        }
        button:disabled {
            cursor: not-allowed;
            opacity: 0.2;
        }
        .genericButton {
            margin: 2.5vw;
            border: none;
            border-radius: 0.5vw;
            padding-left: 20px;
            padding-right: 20px;
            background-color: #4229B9;
            color: #FFFFFF;
            font-family: 'MinecraftTen';
            font-size: 3vw;
            transition: 0.25s;
        }
        .genericButton:hover {
            border-radius: 1vw;
            background-color: #1b0879;
            color: #fcf2ff;
        }
        .genericButton:active {
            border-radius: 1.5vw;
            background-color: #100546;
            transform: translate(10px,10px);
        }
        .buttonWrapper {
            width: 100vw; 
            height: 15vh; 
            display: flex; 
            justify-content: center;
        }
        #creditFormat {
            text-align: left; 
            padding-left: 10vw;
            width: 80vw;
        }
        #creditFormat > img {
            margin-left: 5vw;
            border-radius: 20px;
            width: 70vw;
        }
        @media (max-aspect-ratio: 3/4) {
            .downloadSection{
                margin-bottom: 5vh;
            }
            #fakeLogo {
                height: 15vw;
                margin-left: 16vw;
                font-size: 3vh;
                z-index: 40;
            }
            .hidden {
                height: 7vh;
            }
            .mobile-nav {
                display: flex;
                flex-direction: column;
            }
            .hamburger {
                display: block;
            }
            #desktopNav {
                display: none;
            }
            .topnav {
                height: 15vw;
            }
            .topnav a {
                padding: 4vw 2vw;
                font-size: 8vw;
            }
            h2 {
                margin-left: 5vw !important;
                font-size: 9vw !important;
                margin-top: 2vh !important;
                margin-bottom: 2vh !important;
            }
            .knowSelect {
                font-size: 2.2vh;
                height: 4vh;
            }
            .container {
                margin-top: 5vh !important;
                row-gap: 2.5vh !important;
            }
            .box {
                width: 80vw !important;
            }
            .box img{
                width: 80vw !important;
            }
            input[type="checkbox"] {
                margin-right: 20px;
                width: 15px;
                height: 15px;
                margin-top: 20px;
            }
            #tosLabel{
                font-size: 2.5vh;
            }
            .genericButton {
                border: none;
                border-radius: 1vh;
                margin-top: 1.5vh;
                padding-left: 20px;
                padding-right: 20px;
                font-family: 'MinecraftTen';
                font-size: 8vw;
                transition: 0.25s;
            }
            .genericButton:hover {
                background-color: #a800a8;
                color: #fcf2ff;
            }
            .section {
                letter-spacing: -0.15vh;
                line-height: 3.5vh;
                width: 95vw;
                font-size: 2.5vh;
            }
            #content{
                padding-left: 2.5vw;
                padding-right: 2.5vw;
            }
            #content > img {
                border-radius: 10px;
                width: 95vw;
            }
            #creditFormat > img {
                margin-left: -7.5vw;
                border-radius: 10px;
                width: 95vw;
            }
            #content > video {
                border-radius: 10px;
                width: 95vw;
            }
            .buttonWrapper {
                height: 7.5vh;
            }
        }
    </style>
</head>
<body>
    <iframe id="loadingScreen" src="/loading.html" style="position: fixed; width: 100vw; height: 100vh; z-index: 50; background-color: white;"></iframe>
	<div class="topnav" id="myTopnav">
		<video id="hoverVideo" src="/assets/media/rotatingBlock2D.webm" class="hidden" type="video/webm" style="z-index: 40; position: fixed; margin-left: 1vw;" muted loop>BlockState Team</video>
		<div id="fakeLogo">BlockState <br>Team</div>
		<nav id="desktopNav">
			<a href="project" class="active">Project</a>
			<a href="announcement">Announcement</a>
			<a href="contact">Contact</a>
			<a href="our_story">Our Story</a>
			<a href="/">Home</a>
		</nav>
		<button class="hamburger">
			<div class="bar"></div>
		</button>
		<div class="mobile-nav">
			<a href="/">Home</a>
			<a href="our_story">Our Story</a>
			<a href="contact">Contact</a>
			<a href="announcement">Announcement</a>
			<a href="project" class="active">Project</a>
		</div>
	</div>
    <div id="projectPage">
        <div id="projectPageContent">
            <h2>Our official released projects!</h2>
            <select id="filter" class="knowSelect">
                <option value="latest">Latest</option>
                <option value="oldest">Oldest</option>
                <option value="addon">Add-On</option>
                <option value="map">Map</option>
                <option value="tool">Tool</option>
            </select>
            <div class="container">
            </div>
        </div>
        <div id="projectContent">
        </div>
        <div id="belowSection">
            <h2>HELP SECTION</h2>
            <div class="section">
                If you need any help, feel free to join our Discord!
                <div class="buttonWrapper">
                    <a href="https://discord.gg/p3FvBh2aBd">
                        <button class="genericButton">Discord</button>
                    </a>
                </div>
            </div>
            <h2>DOWNLOAD SECTION</h2>
            <div class="downloadSection">
                <label for="tosCheckbox">
                <input type="checkbox" id="tosCheckbox">
                <span id="tosLabel">I <span style="text-decoration: underline;">disagree</span> to the <a href="/TOS" target="_blank">Term of service</a></span>
                </label><br>
                <button class="genericButton" id="genericButton" disabled>Download Now!</button>
            </div>
            <div class="compiler">
                <iframe src="/loading.html" style="width: 80vw; height: 95vh; background-color: white; border-radius: 2vw; z-index: 50;"></iframe>
            </div>
            <div id="loadingBar" class="compiler" style="background-color: black; height:20px; width:60vw; margin-left: 20vw; z-index: 51; top: 69vh; display: none;">
                <div id="loadingBarRun" style="background-color: magenta; width:0%; height: inherit; z-index: 52; position: relative; left: 0;"></div>
            </div>
            <div class="compiler" id="loadingText" style="max-width: 90vw; margin-left: 5vw; text-overflow: clip; font-size: 5vw; font-family: 'MinecraftTen'; z-index: 49; margin-top: 28vh; background-color: rgba(0, 0, 0, 0) !important;">
                LOADING...
            </div>
        </div>
    </div>
    <script>
        function showLoadingScreen() {
            const loadingScreen = document.getElementById("loadingScreen");
            loadingScreen.style.opacity = "0";
            loadingScreen.style.visibility = "visible";
        }
        function hideLoadingScreen() {
            const loadingScreen = document.getElementById("loadingScreen");
            loadingScreen.style.opacity = "1";
            setTimeout(() => {
                const fadeOutStep = () => {
                    const currentOpacity = parseFloat(loadingScreen.style.opacity) - (1 / 50);
                    loadingScreen.style.opacity = currentOpacity;

                    if (currentOpacity <= 0) {
                        loadingScreen.style.visibility = "hidden";
                        clearInterval(fadeInterval);
                    }
                };
                const fadeInterval = setInterval(fadeOutStep, 1000 / 50);
            }, 1000);
        }
        window.addEventListener("load", () => {
            hideLoadingScreen()
        });
        window.onload = function () {
            const menu_btn = document.querySelector('.hamburger');
            const mobile_menu = document.querySelector('.mobile-nav');

            menu_btn.addEventListener('click', function () {
                menu_btn.classList.toggle('is-active');
                mobile_menu.classList.toggle('is-active');
            });
        }
        document.addEventListener('DOMContentLoaded', () => {
            const video = document.getElementById('hoverVideo');
            video.pause();
            video.addEventListener('mouseover', () => {
                video.play();
            });
            video.addEventListener('mouseout', () => {
                video.pause();
                video.currentTime = 0;
            });
        });
        let projectData, workingTV, headDecoration, musicExtension;
        function displayProjectPage(title, projectName) {
            window.history.pushState({}, document.title, window.location.href);
            window.history.replaceState({}, title, `/projects/${projectName}`);
            reloadPage();
        }
        window.addEventListener('popstate', () => {
            document.getElementById('projectContent').innerHTML = '';
            reloadPage();
        });
        function reloadPage() {
            window.scrollTo(0, 0);
            let currentUrl = window.location.pathname.replace('.html','');
            if (currentUrl === '/project') {
                console.log(currentUrl, " is the display project page")
                document.getElementById('projectContent').style.display = 'none';
                document.getElementById('projectPageContent').style.display = 'block';
                document.getElementById('projectPage').style.display = 'block';
                document.getElementById('belowSection').style.display = 'none';
                document.title = "Project";
                const container = document.querySelector('.container');
                fetch('/projectList.json')
                .then(response => response.ok ? response.json() : Promise.reject(`Failed to fetch data. Status: ${response.status}`))
                .then(jsonData => {
                    jsonData.forEach((project, index) => {
                        const div = document.createElement('div');
                        div.classList.add('box');
                        div.dataset.order = index + 1;
                        div.dataset.item = project.dataItem;
                        div.innerHTML = `<a onClick="displayProjectPage('${project.project}', '${project.formatName}')"><img src="${project.img}"></a>`;
                        container.appendChild(div);
                    });
                
                })
                .catch(error => console.error('Error fetching data:', error.message));
                document.getElementById('filter').addEventListener('change', function () {
                    const selectedValue = filter.value;
                    switch (selectedValue) {
                        case 'latest':
                            sortItem();
                        break;
                        case 'oldest':
                            sortItem(false);
                        break;
                        case 'addon':
                            onlyShow('addon');
                        break;
                        case 'map':
                            onlyShow('map');
                        break;
                        case 'tool':
                            onlyShow('tool');
                        break;
                    }
                });
                const sortItem = (ascending = true) => {
                    const childDivs = Array.from(container.querySelectorAll('div[data-order]'));
                    childDivs.forEach((div) => {
                        div.style.display = '';
                    });
                    childDivs.sort((a, b) => ascending ? a.dataset.order - b.dataset.order : b.dataset.order - a.dataset.order);
                    childDivs.forEach(div => container.appendChild(div));
                };
                function onlyShow(id) {
                    const childDivs = Array.from(container.querySelectorAll('div[data-item]'));
                    childDivs.forEach((div) => {
                        div.style.display = div.dataset.item === id ? '' : 'none';
                    });
                };
            } else if (currentUrl.startsWith('/projects/')) {
                document.getElementById('belowSection').style.display = 'block';
                document.getElementById('projectPage').style.display = 'block';
                document.getElementById('projectContent').style.display = 'block';
                document.getElementById('projectPageContent').style.display = 'none';
                let currentLanguage = 'en';
                console.log(currentUrl, " is a project page")
                let projectName = currentUrl.replace('/projects/', '');
                fetch(`/json/project/${currentLanguage}/${projectName}.json`)
                .then(response => response.ok ? response.json() : Promise.reject(`Failed to fetch data. Status: ${response.status}`))
                .then(data => {
                    projectData = data;
                    if (data.version === "normal") {
                        document.title = data.title;
                        let html ='';
                        html += `
                        <h2>${data.title}</h2>`;
                        if (data.prewarning) {
                            html += `
                            <div class="warning">
                                ${data.prewarning}
                            </div>
                            `;
                        }
                        html += `
                        <div id="content">
                            <div class="section" style="text-align: left;">
                                ${data.introduction}
                            </div>
                        `;
                        for (let i = 0; i < data.content.length; i++) {
                            let elementContent = data.content[i];
                            if (elementContent.type === 'img') {
                                html += `
                                <img src="/assets/media/${projectName}/${i+1}.webp">
                                <div class="section">
                                    ${elementContent.text}
                                </div>`
                            } else if (elementContent.type === 'video') {
                                html += `
                                <video disableRemotePlayback loop muted autoplay>
                                    <source src="/assets/media/${projectName}/${i+1}.webm" type="video/webm">
                                </video>
                                <div class="section">
                                    ${elementContent.text}
                                </div>`
                            } else if (elementContent.type === 'youtube') {
                                html += `
                                <div class="section">
                                    ${elementContent.text}<br>
                                    ${elementContent.iframe}
                                </div>
                                `
                            } else if (elementContent.type === 'iframe') {
                                html += `
                                <div class="section">
                                    ${elementContent.text}<br>
                                    ${elementContent.iframe}
                                </div>`
                            }
                        }
                        html += `</div>`;
                        if (data.credit) {
                            console.log('Credit section is available');
                            html += `
                            <h2>CREDIT SECTION</h2>
                            <div class="section" id="creditFormat">
                                ${data.credit}
                            </div>
                            `
                        };
                        if (data.customizable) {
                            html += '<style>'
                            for (let i = 0; i < data.customizable.style.length; i++) {
                                html += data.customizable.style[i];
                            }
                            html += '</style>'
                            html += `
                            <h2>CUSTOMIZATION SECTION</h2>
                            ${data.customizable.content}
                            `
                            if (data.downloadLink === 'module-working-tv') {
                                initializeWorkingTV();
                            } else if (data.downloadLink === 'module-head-decoration') {
                                initializeHeadDecoration();
                            } else if (data.downloadLink === 'module-music-extension') {
                                initializeMusicExtension();
                            }
                        };
                        if (data.postwarning) {
                            html += `
                            <div class="warning">
                                ${data.postwarning}
                            </div>`
                        };
                        document.getElementById('projectContent').innerHTML = html;
                    }
                })
                .catch(error => console.error('Error fetching data:', error.message));
            } else {
                console.log(currentUrl, " is a 404 page");
                window.location.href = '/403.html';
            }
        }
        async function initializeWorkingTV() {
            try {
                workingTV = await import('/projects/working-tv.js');
                console.log('working-tv.js module has been loaded');
                workingTV.setupEventListeners();
                console.log('Event listeners have been set up');
            } catch (error) {
                console.error('Error loading the working-tv module:', error);
            }
        }
        async function initializeMusicExtension() {
            try {
                musicExtension = await import('/projects/music-extension.js');
                console.log('music-extension.js module has been loaded');
            } catch (error) {
                console.error('Error loading the working-tv module:', error);
            }
        }
        async function initializeHeadDecoration() {
            try {
                headDecoration = await import('/projects/head-decoration.js');
                console.log('head-decoration.js module has been loaded');
                document.cookie.split('; ').forEach(cookie => {
                    const [cookieName, cookieValue] = cookie.split('=');
                    if (cookieName && cookieValue) {
                        const [name, css] = cookieValue.split('-');
                        if (name && css) headDecoration.handleButtonClick(name, cookieName, css, false);
                    }
                });
                console.log('Event listeners have been set up');
            } catch (error) {
                console.error('Error loading the head-decoration module:', error);
            }
        }
        reloadPage();
        const tosCheckbox = document.getElementById('tosCheckbox');
        const downloadButton = document.getElementById('genericButton');
        tosCheckbox.addEventListener('change', () => {
        if (tosCheckbox.checked) {
            downloadButton.removeAttribute('disabled');
            tosLabel.innerHTML = 'I agree to the <a href="/TOS" target="_blank">Term of service</a>';
        } else {
            downloadButton.setAttribute('disabled', 'disabled');
            tosLabel.innerHTML = 'I <span style="text-decoration: underline;">disagree</span> to the <a href="/TOS" target="_blank">Term of service</a>';
        }
        });
        downloadButton.addEventListener('click', () => {
            if (!tosCheckbox.checked) {
                alert('Please agree to the Terms of Service (TOS) before downloading.');
                return;
            }
            fetch('https://api.ipify.org/')
            .then(r => r.ok ? r.text() : Promise.reject('Network response was not ok'))
            .catch(e => ('undefined', console.error('Error:', e)))
            .then(fetchedData => {
                let formData = new FormData();
                formData.append("entry.606279263", fetchedData);
                formData.append("entry.1080269179", projectData.title.replace('Project: ', ''));
                formData.append("entry.826374623", Date.now());

                return fetch("https://docs.google.com/forms/d/e/1FAIpQLSfiIG0fLLNucnSzChPm9F2gWqkk9GOhUHGHUlYT-k3h-FBRFA/formResponse", { method: "POST", body: formData, mode: "no-cors" });
            })
            .then(() => console.log("Form submitted successfully"))
            .catch(error => console.error("Error:", error));
            if (projectData.downloadLink === 'module-working-tv') {
                workingTV.initializeDownload();
            } else if (projectData.downloadLink === 'module-head-decoration') {
                headDecoration.initializeDownload();
            } else if (projectData.downloadLink === 'module-music-extension') {
                musicExtension.initializeDownload();
            } else {
                window.location.href = projectData.downloadLink;
            }
        });
    </script>
</body>
</html>